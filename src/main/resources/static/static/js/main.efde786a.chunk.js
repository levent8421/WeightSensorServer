(this.webpackJsonpweight_slot_app=this.webpackJsonpweight_slot_app||[]).push([[0],{358:function(e,t,a){e.exports=a(805)},363:function(e,t,a){},364:function(e,t,a){},420:function(e,t,a){},457:function(e,t,a){},464:function(e,t,a){},465:function(e,t,a){},486:function(e,t,a){},488:function(e,t,a){},489:function(e,t,a){},492:function(e,t,a){},493:function(e,t,a){},795:function(e,t,a){},796:function(e,t,a){},804:function(e,t,a){},805:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),o=a(21),s=a.n(o),c=(a(363),a(11)),i=a(12),l=a(13),u=a(14),h=(a(364),a(107)),m=a(32),d=a(10),p={showTabBar:!0,enableTabBar:!1,showHeader:!0,globalTitle:"\u91cd\u529b\u8d27\u9053",routerPath:null,dashboardSlots:[],sensors:[],connections:[],user:{name:"MonolithIoT"}},f={},v=function(e,t){f[e]=t};v("tabBar.set",(function(e,t){return Object(d.a)({},e,{showTabBar:t.data})})),v("router.path.set",(function(e,t){return Object(d.a)({},e,{routerPath:t.data})})),v("dashboard.slot_data.fetch.async",(function(e,t){return Object(d.a)({},e,{dashboardSlots:t.data})})),v("title.set",(function(e,t){return Object(d.a)({},e,{globalTitle:t.data})})),v("sensors.fetch.async",(function(e,t){return Object(d.a)({},e,{sensors:t.data})})),v("sensor.elabel.toggle",(function(e,t){var a,n=e.sensors,r=t.data.sensorId,o=t.data.hasElabel,s=Object(m.a)(n);try{for(s.s();!(a=s.n()).done;){var c=a.value;if(c.id===r){c.hasElabel=o;break}}}catch(i){s.e(i)}finally{s.f()}return Object(d.a)({},e,{sensors:JSON.parse(JSON.stringify(n))})})),v("connections.fetch.async",(function(e,t){return Object(d.a)({},e,{connections:t.data})})),v("connection.delete",(function(e,t){var a=t.data.id,n=e.connections.filter((function(e){return e.id!==a}));return Object(d.a)({},e,{connections:n})})),v("system.tabBar.set",(function(e,t){return Object(d.a)({},e,{enableTabBar:t.data})})),v("system.header.set",(function(e,t){return Object(d.a)({},e,{showHeader:t.data})}));var b=a(343),y=(window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__?window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__({}):h.c)(Object(h.a)(b.a)),E=Object(h.d)((function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0,a=t.type;if(a in f){var n=f[a];return n(e,t)}return e}),y),g=a(19),k=(a(369),a(108)),S=a.n(k),O=(a(420),a(35)),C=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={path:"/"},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.showTabBar&&this.props.enableTabBar,a=this.state.path;return t?r.a.createElement("div",{className:"appTabBar"},r.a.createElement(S.a,{unselectedTintColor:"#949494",tintColor:"#33A3F4",barTintColor:"white",hidden:!this.props.showTabBar,tabBarPosition:"bottom"},r.a.createElement(S.a.Item,{title:"\u770b\u677f",selected:"/"===a,icon:r.a.createElement("i",{className:"iconfont buttonIcon"},"\ue64e"),selectedIcon:r.a.createElement("i",{className:"iconfont buttonIcon buttonIconChecked"},"\ue64e"),onPress:function(){return e.pushPath("/")}}),r.a.createElement(S.a.Item,{title:"\u65e5\u5fd7",selected:"/logs"===a,icon:r.a.createElement("i",{className:"iconfont buttonIcon"},"\ue60c"),selectedIcon:r.a.createElement("i",{className:"iconfont buttonIcon buttonIconChecked"},"\ue60c"),onPress:function(){return e.pushPath("/logs")}}),r.a.createElement(S.a.Item,{title:"\u7f16\u5740",selected:"/address"===a,icon:r.a.createElement("i",{className:"iconfont buttonIcon"},"\ue61b"),selectedIcon:r.a.createElement("i",{className:"iconfont buttonIcon buttonIconChecked"},"\ue61b"),onPress:function(){return e.pushPath("/address")}}),r.a.createElement(S.a.Item,{title:"\u8bbe\u7f6e",selected:"/setting"===a,icon:r.a.createElement("i",{className:"iconfont buttonIcon"},"\ue660"),selectedIcon:r.a.createElement("i",{className:"iconfont buttonIcon buttonIconChecked"},"\ue660"),onPress:function(){return e.pushPath("/setting")}}))):null}},{key:"pushPath",value:function(e){this.setState({path:e}),this.props.history.push({pathname:e})}}]),a}(r.a.Component),w=Object(O.f)(Object(g.b)((function(e,t){return Object(d.a)({},t,{showTabBar:e.showTabBar,enableTabBar:e.enableTabBar})}))(C)),j=(a(45),a(16)),N=a.n(j),I=(a(81),a(25)),T=a.n(I),x=(a(244),a(163)),P=a.n(x),D=(a(55),a(23)),B=a.n(D),U=(a(40),a(4)),H=a.n(U),L=(a(436),a(348)),M=a.n(L),F=(a(228),a(220)),A=a.n(F),R=(a(110),a(51)),_=a.n(R),V=a(160),z=a(349),K=a.n(z);var W=function(){N.a.hide()},Z=function(e){N.a.fail(e)};function J(e){var t=!e.hideLoading;return t&&N.a.loading("Loading",0),new Promise((function(a,n){(function(e){return K()(e)})(e).then((function(e){if(t&&W(),200!==e.status)return Z("Http Response Status:".concat(e.status)),void n(e);var r=e.data;if(200!==r.code)return Z("Error [".concat(r.code,"]:").concat(r.msg)),void n(e);a(r.data)})).catch((function(e){t&&W();var a=e.toString();Z(a),n(e)}))}))}var Y=function(){return J({url:"/api/sensor/reload",method:"post"})},X=function(e){return{type:"tabBar.set",data:e}},q=function(e){return{type:"title.set",data:e}},G=function(){return function(e){J({url:"/api/dashboard/slot-data",method:"get",hideLoading:!0}).then((function(t){var a=[];for(var n in t)t.hasOwnProperty(n)&&a.push(t[n]);var r={type:"dashboard.slot_data.fetch.async",data:a.sort((function(e,t){return e.slotNo.localeCompare(t.slotNo)}))};e(r)}))}},$=function(){return function(e){J({url:"/api/sensor/_with-slot",method:"get"}).then((function(t){var a=t.sort((function(e,t){return e.address-t.address}));e({type:"sensors.fetch.async",data:a})}))}},Q=function(e,t){return function(a){(function(e,t){return J({url:"/api/sensor/".concat(e,"/haselabel"),method:"post",data:{hasElabel:t}})})(e,t).then((function(){a({type:"sensor.elabel.toggle",data:{sensorId:e,hasElabel:t}})}))}},ee=function(){return function(e){J({url:"/api/connection/",method:"get"}).then((function(t){e({type:"connections.fetch.async",data:t})}))}},te=function(e){return function(t){(function(e){return J({url:"/api/connection/".concat(e),method:"delete"})})(e).then((function(){t({type:"connection.delete",data:{id:e}})}))}},ae=function(){return function(e){J({url:"/api/config/application.ui.enable_tabBar",method:"get"}).then((function(t){var a={type:"system.tabBar.set",data:"true"===t.value};e(a)}))}},ne=function(e){return function(t){(function(e){return J({url:"/api/config/application.ui.enable_tabBar",method:"post",data:{value:e}})})(e).then((function(){t({type:"system.tabBar.set",data:e})}))}},re=function(e){return{type:"system.header.set",data:e}},oe=(a(457),{1:"\u4e32\u53e3",2:"\u7f51\u7edc"}),se=function(e){return e in oe?oe[e]:"Unknown [".concat(e,"]")},ce={S:1,D:2,F:3},ie=function(e,t){var a=e.slotNo,n=t.slotNo,r=a.split("-"),o=n.split("-");if(r.length!==o.length)return r.length-o.length;for(var s=0;s<r.length;s++){var c=parseInt(r[s]),i=parseInt(o[s]);if(c&&i&&c!==i)return c-i}return 0},le={1:"\u4f7f\u7528\u4e2d",2:"\u79bb\u7ebf",3:"\u5df2\u505c\u7528",4:"\u8d85\u8f7d",5:"\u6b20\u8f7d"},ue=function(e){return e in le?le[e]:"Unknown State:"+e},he={4:"\u8fc7\u9ad8",5:"\u8fc7\u4f4e",1:"\u6b63\u5e38"},me=function(e){return e in he?he[e]:"\u672a\u77e5"+e},de=function(){return J({url:"/api/slot/zero-all",method:"post"})},pe=function(e){var t=encodeURIComponent(e);return J({url:"/api/slot/".concat(t,"/zero"),method:"post"})},fe=function(e){return J({url:"/api/slot/".concat(e),method:"get"})},ve=[{title:"\u91cd\u529b\u8d27\u9053\u6570\u636e",key:"dashboard"},{title:"\u91cd\u529b\u8d27\u9053\u914d\u7f6e",key:"settings"}],be=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).rootEle=document,n.state={slots:[],groupedSlots:[],thSensors:[],sensors:[],sensorModalVisible:!1,operationSlot:{},searchSkuNo:"",noticeSlots:[]},n.props.setTitle("Dashboard"),n.renderSlotCard=n.renderSlotCard.bind(Object(V.a)(n)),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.startFetchData(),this.props.showHeader(!1),this.props.showTabBar(!1),this.listenKeyPress()}},{key:"listenKeyPress",value:function(){var e=this;this.rootEle.onkeypress=function(t){if("body"===t.target.tagName.toLowerCase()){var a=t.keyCode;13===a?e.triggerHighlight(e.state.searchSkuNo):e.appendSearchSku(String.fromCharCode(a))}}}},{key:"appendSearchSku",value:function(e){var t=this.state.searchSkuNo;this.setState({searchSkuNo:t+e})}},{key:"componentWillUnmount",value:function(){this.fetchTimer&&clearInterval(this.fetchTimer),this.props.showHeader(!0),this.props.showTabBar(!0),this.cancelKeyPress()}},{key:"cancelKeyPress",value:function(){this.rootEle.onkeypress=null}},{key:"startFetchData",value:function(){var e=this;this.fetchTimer=setInterval((function(){J({url:"/api/dashboard/_data",method:"get",hideLoading:!0}).then((function(t){var a=t.slotData,n=t.temperatureHumidityData,r=[],o=[];for(var s in a)a.hasOwnProperty(s)&&r.push(a[s]);for(var c in n)n.hasOwnProperty(c)&&o.push(n[c]);var i=function(e){var t,a={},n=function(e,t){e in a?a[e].push(t):a[e]=[t]},r=Object(m.a)(e);try{for(r.s();!(t=r.n()).done;){var o=t.value,s=o.slotNo.match(/^(\w+)-(\w+)-(\w+)$/);if(s)n("".concat(s[1],"\u8d27\u67b6\u7b2c").concat(s[2],"\u5c42"),o);else n("\u672a\u5206\u7ec4\u8d27\u9053",o)}}catch(u){r.e(u)}finally{r.f()}var c=[];for(var i in a)if(a.hasOwnProperty(i)){var l=a[i];c.push({name:i,slots:l.sort(ie)})}return c.sort((function(e,t){var a=ce[e.name.substring(0,1)],n=ce[t.name.substring(0,1)];return a!==n?a-n:e.name.localeCompare(t.name)}))}(r);e.setState({slots:r,thSensors:o,groupedSlots:i})}))}),1e3)}},{key:"renderThSensorCard",value:function(e){var t=e.data,a=t.temperature,n=t.humidity;a=a&&a.toFixed(1);var o=me(t.temperatureState),s=1!==t.temperatureState,c=n&&n.toFixed(1),i=["value"];return s?i.push("warn"):i.push("ok"),r.a.createElement("div",{className:"th-card",key:e.id},r.a.createElement("div",{className:"card-header"},r.a.createElement("div",{className:"no"},e.no),r.a.createElement("div",{className:"state"},r.a.createElement("span",null,c,"%"),r.a.createElement("span",{className:"dot"}),"\u4f7f\u7528\u4e2d")),r.a.createElement("div",{className:"card-body"},r.a.createElement("div",{className:"inner"},r.a.createElement("div",{className:"item"},r.a.createElement("span",{className:"name"},"\u6e29\u5ea6:"),r.a.createElement("span",{className:i.join(" ")},a,"\xb0C")),r.a.createElement("div",{className:"delimiter"}),r.a.createElement("div",{className:"item"},r.a.createElement("span",{className:"name"},"\u72b6\u6001"),r.a.createElement("span",{className:i.join(" ")},o)))))}},{key:"renderThSensors",value:function(){var e=this,t=this.state.thSensors;return r.a.createElement("div",{className:"th-sensor-group"},r.a.createElement("div",{className:"title"},"\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668"),r.a.createElement(_.a,{className:"sensors"},t.map((function(t){return e.renderThSensorCard(t)}))))}},{key:"render",value:function(){var e=this,t=this.state,a=t.searchSkuNo,n=t.noticeSlots,o=t.sensorModalVisible,s=t.operationSlot,c=t.sensors,i=t.groupedSlots;this.highlightSlotIds={};var l,u=Object(m.a)(n);try{for(u.s();!(l=u.n()).done;){var h=l.value;this.highlightSlotIds[h.id]=!0}}catch(p){u.e(p)}finally{u.f()}var d=n?n[0]:null;return r.a.createElement("div",{className:"dashboard"},r.a.createElement(A.a,{tabs:ve,onChange:function(t,a){return e.onTabChange(t,a)}}),r.a.createElement(M.a,{value:a,onSubmit:function(t){return e.triggerHighlight(t)},onChange:function(t){return e.setState({searchSkuNo:t})}}),r.a.createElement("div",{className:"notice-list"},this.renderNoticeBar(d)),r.a.createElement("div",{className:"slot-groups"},i.map((function(t){return e.renderGroupItem(t)}))),r.a.createElement("div",{className:"th-sensors"},this.renderThSensors()),r.a.createElement(B.a,{visible:o,title:"Sensors for ".concat(s.slotNo),transparent:!0,footer:[{text:"OK",onPress:function(){return e.setState({sensorModalVisible:!1})}},{text:"DoZero",onPress:function(){return e.doSlotZero(e.state.operationSlot)}}],onClose:function(){return e.setState({sensorModalVisible:!1})}},r.a.createElement(H.a,{renderHeader:function(){return"Sensors"}},c?c.map((function(e){return r.a.createElement(H.a.Item,{extra:ue(e.state),key:e.id},e.deviceSn,r.a.createElement(H.a.Item.Brief,null,e.address485))})):r.a.createElement(H.a.Item,null,"Empty List"))),r.a.createElement("div",{className:"clear-float"}),r.a.createElement("div",{className:"bottom-white"},"\u7559\u767d"))}},{key:"renderNoticeBar",value:function(e){if(e){var t=[];return t.push(e.skuName),e.skuShelfLifeOpenDays?(t.push("\uff0c\u5f00\u5c01\u540e\u4fdd\u8d28\u671f"),t.push(r.a.createElement("span",{className:"days"},e.skuShelfLifeOpenDays)),t.push("\u5929")):t.push("\uff0c\u5f00\u5c01\u540e\u4fdd\u8d28\u671f\u672a\u8bbe\u7f6e\uff01"),r.a.createElement(P.a,{className:"notice"},t)}}},{key:"renderGroupItem",value:function(e){var t=this;return r.a.createElement("div",{className:"group-item",key:e.name},r.a.createElement("p",{className:"group-name"},e.name),r.a.createElement(_.a,null,r.a.createElement(T.a,{className:"slots",wrap:"wrap",justify:"between"},e.slots.map((function(e){return t.renderSlotCard(e)})))))}},{key:"renderSlotCard",value:function(e){var t=this;if(!e.sensors)return null;var a=e.sku||{},n=e.data||{},o="slot-card";e.id in this.highlightSlotIds?o+=" slot-card-highlight":function(e){return 1!==e}(e.state)&&(!function(e){return 3===e}(e.state)?!function(e){return 2===e}(e.state)?o+=" slot-card-warn":o+=" slot-card-offline":o+=" slot-card-disable");var s=function(e){return 1!==e}(n.toleranceState),c=ue(e.state),i=(n.weight/1e3).toFixed(3),l=function(e){var t=e.count,a=1===e.weightState;return null===t?"~\u2757":a?t:"~"+t}(n);return r.a.createElement("div",{key:e.id,className:o},r.a.createElement(T.a,{className:"card-header",justify:"between"},r.a.createElement("div",{className:"slot-no"},e.slotNo),r.a.createElement("div",{className:"state"},r.a.createElement("span",{className:"weight"},"(",i,"kg)"),r.a.createElement("span",{className:"dot"}),r.a.createElement("span",null,c))),r.a.createElement(T.a,{className:"card-body",justify:"between"},r.a.createElement("div",{className:"left"},r.a.createElement("div",{className:"sku-no"},"SKU:",a.skuNo),r.a.createElement("div",{className:"sku-name"},a.name)),r.a.createElement("div",{className:"delimiter"}),r.a.createElement("div",{className:"right ".concat(s?"right-incredible":""),onClick:function(){return t.onSlotCardClick(e)}},r.a.createElement("span",{className:"pcs-value"},l),r.a.createElement("span",{className:"pcs-unit"},"(\u6570\u91cf)"))))}},{key:"onSlotCardClick",value:function(e){this.setState({operationSlot:e,sensors:e.sensors,sensorModalVisible:!0})}},{key:"triggerHighlight",value:function(e){var t,a=this;""!==e&&""!==e.trim()?(t=e,J({url:"/api/slot/highlight",method:"post",data:{skuNo:t}})).then((function(e){a.setState({noticeSlots:e}),setTimeout((function(){return a.setState({noticeSlots:[],searchSkuNo:""})}),5e3)})).catch((function(){a.setState({searchSkuNo:""})})):N.a.show("Please Type a SkuNo!",1,!1)}},{key:"onTabChange",value:function(e,t){switch(t){case 0:this.props.history.push({pathname:"/dashboard"});break;case 1:this.props.history.push({pathname:"/setting/"})}}},{key:"doSlotZero",value:function(e){var t=this,a=e.slotNo;B.a.alert("Do Zero?","Do zero for this clot[".concat(a,"]?"),[{text:"Cancel"},{text:"Yes",onPress:function(){return t.callDoZero(a)}}])}},{key:"callDoZero",value:function(e){pe(e).then((function(){N.a.show("slot[".concat(e,"] Zero success!"))}))}}]),a}(n.Component),ye=Object(g.b)((function(e,t){return Object(d.a)({},t,{slots:e.dashboardSlots})}),(function(e,t){return Object(d.a)({},t,{fetchSlotData:function(){return e(G.apply(void 0,arguments))},setTitle:function(){return e(q.apply(void 0,arguments))},showHeader:function(){return e(re.apply(void 0,arguments))},showTabBar:function(){return e(X.apply(void 0,arguments))}})}))(be),Ee=Object(O.f)(ye),ge=a(48),ke=(a(69),a(41)),Se=a.n(ke),Oe=(a(182),a(106)),Ce=a.n(Oe),we=(a(137),a(37)),je=a.n(we),Ne=(a(95),a(61)),Ie=a.n(Ne),Te=(a(464),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).defaultPosition={right:20,bottom:100},n.state={down:!1},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.state.down;return r.a.createElement("div",{className:"floatButton "+(t?"move":""),style:this.defaultPosition,onClick:function(t){return e.callOnClick(t)}},r.a.createElement(Ie.a,{type:this.props.iconType,className:"icon"}))}},{key:"callOnClick",value:function(e){this.props.onClick&&this.props.onClick(e)}}]),a}(n.Component)),xe=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.props.setTabBarState(!1),n}return Object(i.a)(a,[{key:"render",value:function(){var e=this,t=this.props.sensors;return r.a.createElement("div",{className:"slotSetting"},r.a.createElement(H.a,{renderHeader:function(){return"\u4f20\u611f\u5668\u5217\u8868"}},t.map((function(t){return r.a.createElement(H.a.Item,{key:t.id},r.a.createElement(je.a,null,r.a.createElement(je.a.Header,{title:"\u5730\u5740:".concat(t.address),extra:t.deviceSn}),r.a.createElement(je.a.Body,null,r.a.createElement(H.a,null,r.a.createElement(H.a.Item,{extra:r.a.createElement(Ce.a,{checked:t.hasElabel,onChange:function(a){return e.toggleElabel(t,a)},platform:"android"})},"\u542f\u7528\u7535\u5b50\u6807\u7b7e"),r.a.createElement(H.a.Item,{arrow:"horizontal",onClick:function(){return e.toSensorDetails(t)}},"\u4f20\u611f\u5668\u8be6\u7ec6\u53c2\u6570"))),r.a.createElement(je.a.Footer,{content:"\u7ed1\u5b9a\u8d27\u9053:[".concat(t.slot&&t.slot.slotNo,"]"),extra:t.slot&&t.slot.id})))}))),r.a.createElement(Te,{iconType:"ellipsis",onClick:function(){return e.showOperationActions()}}))}},{key:"toSensorDetails",value:function(e){this.props.history.push({pathname:"/setting/".concat(e.address,"/sensor-details")})}},{key:"componentDidMount",value:function(){this.props.setTitle("\u91cd\u529b\u4f20\u611f\u5668\u8bbe\u7f6e"),this.props.fetchSensors()}},{key:"toggleElabel",value:function(e,t){var a=e.id;this.props.toggleSensorElable(a,t)}},{key:"showOperationActions",value:function(){var e=this,t=["\u91cd\u65b0\u52a0\u8f7d","\u53d6\u6d88"];Se.a.showActionSheetWithOptions({title:"\u64cd\u4f5c\u9009\u62e9",options:t,cancelButtonIndex:t.length-1,destructiveButtonIndex:0},(function(t){0===t&&e.callReloadSensors()}))}},{key:"callReloadSensors",value:function(){B.a.alert("\u91cd\u65b0\u52a0\u8f7d","\u786e\u5b9a\u91cd\u65b0\u52a0\u8f7d\uff0c\u8be5\u64cd\u4f5c\u9700\u7b49\u5230\u4e00\u6bb5\u65f6\u95f4\uff0830s\uff09\u624d\u53ef\u751f\u6548?",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",onPress:function(){Y().then((function(){N.a.show("\u52a0\u8f7d\u6210\u529f!",1,!1)}))}}])}}]),a}(n.Component),Pe=Object(g.b)((function(e,t){return Object(d.a)({},t,{sensors:e.sensors})}),(function(e,t){return Object(d.a)({},t,{fetchSensors:function(){return e($.apply(void 0,arguments))},toggleSensorElable:function(){return e(Q.apply(void 0,arguments))},setTitle:function(){return e(q.apply(void 0,arguments))},setTabBarState:function(){return e(X.apply(void 0,arguments))}})}))(xe),De=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.props.setTitle("\u8bbe\u7f6e"),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTabBarState(!0)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"setting"},r.a.createElement(H.a,{renderHeader:function(){return"Settings:"}},r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/sensor")},arrow:"horizontal"},"\u91cd\u529b\u4f20\u611f\u5668"),r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/th-sensor")},arrow:"horizontal"},"\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668"),r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/slot")},arrow:"horizontal"},"\u8d27\u9053\u7ba1\u7406"),r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/connection")},arrow:"horizontal"},"\u8fde\u63a5\u7ba1\u7406"),r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/system")},arrow:"horizontal"},"\u7cfb\u7edf\u4fe1\u606f"),r.a.createElement(H.a.Item,{arrow:"horizontal",onClick:function(){return e.go("/setting/system-check")}},"\u7cfb\u7edf\u68c0\u67e5"),r.a.createElement(H.a.Item,{onClick:function(){return e.go("/setting/overview")},arrow:"horizontal"},"\u8d27\u9053\u6982\u89c8\u4fe1\u606f")))}},{key:"go",value:function(e){this.props.history.push({pathname:e})}}]),a}(n.Component),Be=Object(O.f)(Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))},setTabBarState:function(){return e(X.apply(void 0,arguments))}})}))(De)),Ue=(a(465),["\u5237\u65b0","\u5168\u90e8\u6e05\u96f6","\u53d6\u6d88"]),He=H.a.Item,Le=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={slots:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTabBarState(!1),this.props.setTitle("\u91cd\u529b\u8d27\u9053\u8bbe\u7f6e"),this.fetchSlots()}},{key:"render",value:function(){var e=this,t=this.state.slots;return r.a.createElement("div",{className:"slotSetting"},r.a.createElement(H.a,{renderHeader:function(){return"\u91cd\u529b\u8d27\u9053\u5217\u8868"}},t.map((function(t){return r.a.createElement(He,{key:t.id,arrow:"horizontal",onClick:function(){return e.toSlotDetail(t)}},r.a.createElement(T.a,{justify:"between"},r.a.createElement("span",{className:"slotNo"},t.slotNo),r.a.createElement("span",{className:"name"},t.skuName)))}))),r.a.createElement(Te,{iconType:"ellipsis",onClick:function(){return e.showOperationSheet()}}))}},{key:"showOperationSheet",value:function(){var e=this;Se.a.showActionSheetWithOptions({options:Ue,title:"\u64cd\u4f5c\u9009\u62e9",cancelButtonIndex:Ue.length-1,destructiveButtonIndex:1},(function(t){switch(t){case 0:e.fetchSlots();break;case 1:e.doZeroAll()}}))}},{key:"toSlotDetail",value:function(e){this.props.history.push({pathname:"/setting/slot-detail/".concat(e.id)})}},{key:"doZeroAll",value:function(){de().then((function(){N.a.show("\u5168\u90e8\u8d27\u9053\u5df2\u7ecf\u88ab\u6e05\u96f6!")}))}},{key:"fetchSlots",value:function(){var e=this;J({url:"/api/slot/",method:"get"}).then((function(t){var a=t.sort((function(e,t){return e.slotNo.localeCompare(t.slotNo)}));e.setState({slots:a})}))}}]),a}(n.Component),Me=Object(O.f)(Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTabBarState:function(){return e(X.apply(void 0,arguments))},setTitle:function(){return e(q.apply(void 0,arguments))}})}))(Le)),Fe=(a(254),a(127)),Ae=a.n(Fe),Re=(a(183),a(44)),_e=a.n(Re),Ve=(a(70),a(36)),ze=a.n(Ve),Ke=(a(486),["\u5220\u9664","\u626b\u63cf\u91cd\u529b\u8d27\u9053","\u626b\u63cf\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668","\u53d6\u6d88"]),We=[{label:"\u4e32\u53e3",value:1},{label:"\u7f51\u7edc",value:2}],Ze=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={createDialogVisible:!1,create:{type:null,target:""},serialPorts:[]},n.props.setTitle("\u7269\u7406\u8fde\u63a5\u8bbe\u7f6e"),n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.fetchConnection(),this.props.setTabBarState(!1)}},{key:"render",value:function(){var e=this,t=H.a.Item,a=this.props.connections,n=this.state.createDialogVisible,o=this.state.create;return r.a.createElement("div",null,r.a.createElement(H.a,{renderHeader:function(){return"\u8fde\u63a5\u5217\u8868"}},a.map((function(a){return r.a.createElement(t,{key:a.id,arrow:"horizontal",onClick:function(){return e.showConnectionOperations(a)}},r.a.createElement(T.a,{justify:"between",className:"connectionItem"},r.a.createElement("span",{className:"type"},se(a.type)),r.a.createElement("span",{className:"target"},a.target)))})),r.a.createElement(t,{key:"createButton"},r.a.createElement(ze.a,{type:"primary",onClick:function(){return e.showCreateDialog()}},"\u521b\u5efa\u8fde\u63a5"))),r.a.createElement(B.a,{visible:n,transparent:!0,title:"\u521b\u5efa\u8fde\u63a5",footer:[{text:"\u53d6\u6d88",onPress:function(){return e.setState({createDialogVisible:!1})}},{text:"\u521b\u5efa",onPress:function(){return e.createConnection()}}],onClose:function(){return e.setState({createDialogVisible:!1})}},r.a.createElement(H.a,null,r.a.createElement(Ae.a,{data:We,title:"\u8fde\u63a5\u7c7b\u578b",cols:1,extra:"\u8bf7\u9009\u62e9",onChange:function(t){return e.setCreateType(t)}},r.a.createElement(H.a.Item,null,r.a.createElement(_e.a,{value:o.type&&se(o.type),disabled:!0,placeholder:"\u7c7b\u578b"}))),function(){var t=r.a.createElement(H.a.Item,{key:"target"},r.a.createElement(_e.a,{placeholder:"Connection Target",onChange:function(t){return e.setCreateTarget(t)},value:o.target,disabled:1===e.state.create.type}));return 1===o.type?r.a.createElement(Ae.a,{data:e.state.serialPorts,extra:"\u9009\u62e9",title:"\u4e32\u53e3\u5217\u8868",cols:1,onChange:function(t){return e.setCreateTargetSerial(t)}},t):t}())))}},{key:"deleteConnection",value:function(e){var t=this;B.a.alert("\u5220\u9664\u8fde\u63a5!","\u786e\u5b9a\u5220\u9664\u8fde\u63a5\uff1f",[{text:"\u53d6\u6d88"},{text:"\u5220\u9664",onPress:function(){t.props.deleteConnection(e.id)}}])}},{key:"scanConnection",value:function(e){B.a.alert("\u626b\u63cf\u91cd\u529b\u4f20\u611f\u5668!","\u626b\u63cf\u8be5\u8fde\u63a5\u4e0b\u7684\u4f20\u611f\u5668\uff1f?",[{text:"\u53d6\u6d88"},{text:"\u626b\u63cf",onPress:function(){var t;(t=e.id,J({url:"/api/connection/".concat(t,"/_scan"),method:"post"})).then((function(){N.a.show("\u626b\u63cf\u5df2\u5f00\u59cb!",2,!1)}))}}])}},{key:"showCreateDialog",value:function(){this.setState({createDialogVisible:!0})}},{key:"createConnection",value:function(){var e,t=this;(e=this.state.create,J({url:"/api/connection/",method:"put",data:e})).then((function(){t.props.fetchConnection(),t.setState({create:{},createDialogVisible:!1})}))}},{key:"setCreateType",value:function(e){var t=this;e.length<1&&N.a.show("\u8bf7\u9009\u62e9\u8fde\u63a5\u7c7b\u578b!");var a=e[0],n={type:a,target:""};this.setState({create:n}),1===a&&this.state.serialPorts.length<=0&&J({url:"/api/serial/scan",method:"get"}).then((function(e){var a,n=[],r=Object(m.a)(e);try{for(r.s();!(a=r.n()).done;){var o=a.value;n.push({label:o,value:o})}}catch(s){r.e(s)}finally{r.f()}t.setState({serialPorts:n})}))}},{key:"setCreateTarget",value:function(e){var t=Object(d.a)({},this.state.create,{target:e});this.setState({create:t})}},{key:"setCreateTargetSerial",value:function(e){if(e){var t=e[0],a=Object(d.a)({},this.state.create,{target:t});this.setState({create:a})}else N.a.show("\u8bf7\u9009\u62e9\u4e32\u53e3!")}},{key:"startScanTHSensors",value:function(e){B.a.alert("\u626b\u63cf\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668!","\u626b\u63cf\u8be5\u8fde\u63a5\u4e0b\u7684\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668?",[{text:"\u53d6\u6d88"},{text:"\u626b\u63cf",onPress:function(){var t;(t=e.id,J({url:"/api/connection/".concat(t,"/_scan-th-device"),method:"post"})).then((function(){N.a.show("\u626b\u63cf\u5df2\u5f00\u59cb!",2,!1)}))}}])}},{key:"showConnectionOperations",value:function(e){var t=this;Se.a.showActionSheetWithOptions({title:"".concat(e.target," \u64cd\u4f5c"),options:Ke,cancelButtonIndex:Ke.length-1,destructiveButtonIndex:0},(function(a){switch(a){case 0:t.deleteConnection(e);break;case 1:t.scanConnection(e);break;case 2:t.startScanTHSensors(e)}}))}}]),a}(n.Component),Je=Object(g.b)((function(e,t){return Object(d.a)({},t,{connections:e.connections})}),(function(e,t){return Object(d.a)({},t,{fetchConnection:function(){return e(ee.apply(void 0,arguments))},setTitle:function(){return e(q.apply(void 0,arguments))},deleteConnection:function(){return e(te.apply(void 0,arguments))},setTabBarState:function(){return e(X.apply(void 0,arguments))}})}))(Ze),Ye=["\u6e05\u96f6\u8be5\u8d27\u9053","\u5220\u9664\u8d27\u9053","\u53d6\u6d88"],Xe=H.a.Item,qe=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={slot:{}},n.slotId=n.props.match.params.id,n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("".concat(this.slotId," \u8d27\u9053\u8bbe\u7f6e")),this.fetchSlotInfo()}},{key:"fetchSlotInfo",value:function(){var e=this;fe(this.slotId).then((function(t){e.setState({slot:t}),e.props.setTitle("".concat(t.slotNo," \u8d27\u9053\u8bbe\u7f6e"))}))}},{key:"render",value:function(){var e=this,t=this.state.slot;return r.a.createElement("div",{className:"slotDetail"},r.a.createElement(H.a,{renderHeader:function(){return"\u8d27\u9053\u4fe1\u606f"}},r.a.createElement(Xe,{key:"slotNo"},r.a.createElement(_e.a,{placeholder:"\u903b\u8f91\u8d27\u9053\u53f7",value:t.slotNo,onChange:function(t){return e.setUpdateSlotProp({slotNo:t})}},"\u8d27\u9053\u53f7")),r.a.createElement(Xe,{key:"SkuName"},r.a.createElement(_e.a,{placeholder:"SKU\u540d\u79f0",value:t.skuName,onChange:function(t){return e.setUpdateSlotProp({skuName:t})}},"SKU\u540d\u79f0")),r.a.createElement(Xe,{key:"skuNo"},r.a.createElement(_e.a,{placeholder:"SKU\u53f7",value:t.skuNo,onChange:function(t){return e.setUpdateSlotProp({skuNo:t})}},"SKU\u53f7")),r.a.createElement(Xe,{key:"skuApw"},r.a.createElement(_e.a,{placeholder:"SKU\u5355\u91cd",value:t.skuApw,type:"number",onChange:function(t){return e.setUpdateSlotProp({skuApw:t})}},"SKU\u5355\u91cd")),r.a.createElement(Xe,{key:"skuTolerance"},r.a.createElement(_e.a,{placeholder:"SKU\u5141\u5dee",value:t.skuTolerance,type:"number",onChange:function(t){return e.setUpdateSlotProp({skuTolerance:t})}},"SKU\u5141\u5dee")),r.a.createElement(Xe,{key:"skuShelfLifeOpenDays"},r.a.createElement(_e.a,{placeholder:"\u5f00\u5c01\u540e\u4fdd\u8d28\u5929\u6570",value:t.skuShelfLifeOpenDays,type:"number",onChange:function(t){return e.setUpdateSlotProp({skuShelfLifeOpenDays:t})}},"\u4fdd\u8d28\u671f")),r.a.createElement(Xe,{key:"applyBtn"},r.a.createElement(_.a,null,r.a.createElement(ze.a,{type:"primary",onClick:function(){return e.applyModify()}},"\u4fdd\u5b58")))),r.a.createElement(H.a,{renderHeader:function(){return"Operations"}},r.a.createElement(H.a.Item,{key:"hasELabel",extra:r.a.createElement(Ce.a,{checked:t.hasElabel,onChange:function(t){return e.toggleELabel(t)},platform:"android"})},"\u542f\u7528\u7535\u5b50\u6807\u7b7e"),r.a.createElement(H.a.Item,{arrow:"horizontal",onClick:function(){return e.props.history.push({pathname:"/setting/slot-sensors/".concat(t.id)})}},"\u8d27\u9053\u4f20\u611f\u5668\u7ba1\u7406")),r.a.createElement(Te,{iconType:"ellipsis",onClick:function(){return e.openOperation()}}))}},{key:"openOperation",value:function(){var e=this;Se.a.showActionSheetWithOptions({title:"\u64cd\u4f5c\u9009\u62e9",options:Ye,destructiveButtonIndex:1,cancelButtonIndex:Ye.length-1},(function(t){switch(t){case 0:e.doZero();break;case 1:N.a.show("\u6682\u65f6\u4e0d\u80fd\u5220\u9664\u8d27\u9053",2,!1)}}))}},{key:"doZero",value:function(){var e=this.state.slot;pe(e.slotNo).then((function(){N.a.show("\u6e05\u96f6\u6210\u529f!")}))}},{key:"setUpdateSlotProp",value:function(e){var t=Object(d.a)({},this.state.slot,{},e);this.setState({slot:t})}},{key:"applyModify",value:function(){var e;(e=this.state.slot,J({url:"/api/slot/".concat(e.id),method:"post",data:e})).then((function(){N.a.show("Apply Success!")}))}},{key:"toggleELabel",value:function(e){var t,a=this;(t={id:this.slotId,hasELabel:e},J({url:"/api/slot/".concat(t.id,"/has-e-label"),method:"post",data:{hasElabel:t.hasELabel}})).then((function(){N.a.show("Toggle ELabel Success!"),a.fetchSlotInfo()}))}}]),a}(n.Component),Ge=Object(O.f)(Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(qe)),$e=(a(138),a(62)),Qe=a.n($e),et=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={systemInfo:{},libLoadVisible:!1,reloadLibPath:""},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.setTitle("\u7cfb\u7edf\u4fe1\u606f"),J({url:"/api/dashboard/system-infos",method:"get"}).then((function(t){e.setState({systemInfo:t})}))}},{key:"render",value:function(){var e=this,t=H.a.Item,a=this.state,n=a.systemInfo,o=a.libLoadVisible,s=a.reloadLibPath,c=this.props.enableTabBar;return r.a.createElement("div",{className:"systemSettings"},r.a.createElement(H.a,{renderHeader:function(){return"\u7cfb\u7edf\u4fe1\u606f"}},r.a.createElement(t,{key:"appName",extra:n.appName},"\u5e94\u7528\u540d\u79f0"),r.a.createElement(t,{key:"appVersion",extra:n.appVersion},"\u5e94\u7528\u7248\u672c"),r.a.createElement(t,{key:"dbVersion",extra:n.dbVersion},"\u6570\u636e\u5e93\u7248\u672c"),r.a.createElement(t,{key:"dbVersionName",extra:n.dbVersionName},"\u6570\u636e\u5e93\u7248\u672c\u540d"),r.a.createElement(t,{key:"pid",extra:n.pid},"\u8fdb\u7a0bID"),r.a.createElement(t,{key:"libPath",arrow:"horizontal",onClick:function(){return e.showLibLoadModal()}}," \u9a71\u52a8\u8def\u5f84: ",n.libPath)),r.a.createElement(H.a,{renderHeader:function(){return"\u7cfb\u7edf\u8bbe\u7f6e"}},r.a.createElement(t,{key:"tabBar",extra:r.a.createElement(Ce.a,{checked:c,onChange:function(t){return e.setEnableTabBar(t)},platform:"android"})},"\u5e95\u90e8\u6807\u7b7e\u680f"),r.a.createElement(t,{key:"systemProps",arrow:"horizontal",onClick:function(){return e.props.history.push({pathname:"/setting/system-props"})}},"JVM\u4fe1\u606f"),r.a.createElement(t,{key:"stopService"},r.a.createElement(ze.a,{type:"warning",onClick:function(){return e.stopWeightService()}},"\u505c\u6b62\u91cd\u529b\u670d\u52a1"))),r.a.createElement(B.a,{visible:o,title:"\u91cd\u65b0\u52a0\u8f7d\u9a71\u52a8",transparent:!0,maskClosable:!0,footer:[{text:"\u53d6\u6d88",onPress:function(){return e.showLibLoadModal(!1)}},{text:"\u52a0\u8f7d",onPress:function(){return e.reloadLibrary()}}]},r.a.createElement(Qe.a,{placeholder:"\u9a71\u52a8\u8def\u5f84!",autoHeight:!0,value:s,onChange:function(t){return e.setState({reloadLibPath:t})}})))}},{key:"setEnableTabBar",value:function(e){this.props.setEnableTabBar(e)}},{key:"showLibLoadModal",value:function(){var e=!(arguments.length>0&&void 0!==arguments[0])||arguments[0],t=this.state.systemInfo.libPath;this.setState({reloadLibPath:t,libLoadVisible:e})}},{key:"reloadLibrary",value:function(){var e,t=this;(e=this.state.reloadLibPath,J({url:"/api/serial/load-lib",method:"post",data:{libPath:e}})).then((function(e){N.a.show("\u52a0\u8f7d\u6210\u529f: [".concat(e,"]")),t.setState({libLoadVisible:!1})}))}},{key:"stopWeightService",value:function(){J({url:"/api/sensor/_stop-weight-service",method:"post"}).then((function(){N.a.show("\u91cd\u529b\u670d\u52a1\u5df2\u505c\u6b62!")}))}}]),a}(n.Component),tt=Object(O.f)(Object(g.b)((function(e,t){return Object(d.a)({},t,{enableTabBar:e.enableTabBar})}),(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))},setEnableTabBar:function(){return e(ne.apply(void 0,arguments))}})}))(et)),at=H.a.Item,nt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={systemProps:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.setTitle("JVM\u73af\u5883\u53d8\u91cf"),J({url:"/api/dashboard/system-props",method:"get"}).then((function(t){var a=[];for(var n in t)t.hasOwnProperty(n)&&a.push({name:n,value:t[n]});e.setState({systemProps:a})}))}},{key:"render",value:function(){var e=this.state.systemProps;return r.a.createElement("div",{className:"systemProps"},r.a.createElement(H.a,{renderHeader:function(){return"System Properties"}},e.map((function(e){return r.a.createElement(at,{key:e.name},r.a.createElement("div",null,e.name),r.a.createElement(Qe.a,{value:e.value,autoHeight:!0,labelNumber:5}))}))))}}]),a}(n.Component),rt=Object(g.b)(null,(function(e,t){return console.log(t,e),Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(nt),ot=(a(488),["\u79fb\u9664","\u53d6\u6d88"]),st=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={slot:{},sensors:[],sensorRemoveMode:!1,allSlots:[],sensorPickerData:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.props.setTitle("\u8d27\u9053\u4f20\u611f\u5668\u7ba1\u7406");var t=this.props.match.params.id;fe(t).then((function(t){var a,n=t.sensors,r=Object(m.a)(n);try{for(r.s();!(a=r.n()).done;){a.value.changed=!1}}catch(o){r.e(o)}finally{r.f()}e.setState({slot:t,sensors:n}),e.props.setTitle("\u4f20\u611f\u5668\u7ba1\u7406[".concat(t.slotNo,"]"))})),J({url:"/api/slot/_with-sensors",method:"get"}).then((function(t){var a,n=[],r=Object(m.a)(t);try{for(r.s();!(a=r.n()).done;){var o,s=a.value,c=s.sensors,i=[],l=Object(m.a)(c);try{for(l.s();!(o=l.n()).done;){var u=o.value;i.push({value:u.id,label:u.address})}}catch(h){l.e(h)}finally{l.f()}n.push({value:s.id,label:s.slotNo,children:i})}}catch(h){r.e(h)}finally{r.f()}e.setState({allSlots:t,sensorPickerData:n})}))}},{key:"renderSensorItem",value:function(e){var t=this,a=this.state,n=a.sensorRemoveMode,o=a.sensorPickerData,s=r.a.createElement(H.a.Item,{key:e.id,arrow:"horizontal",className:"sensor-item ".concat(e.changed?"sensor-item-changed":""),onClick:function(){return t.openSensorOperations(e)},extra:n?"\u70b9\u51fb\u5220\u9664":""},e.deviceSn);return n?s:r.a.createElement(Ae.a,{data:o,key:e.id,value:[e.slotId,e.id],cols:2,onChange:function(a){return t.onSelectSensor(e,a)}},s)}},{key:"onSelectSensor",value:function(e,t){var a,n=t[0],r=t[1],o=-1,s=this.state.sensors;for(var c in s){if(s.hasOwnProperty(c))s[c].id===e.id&&(o=c)}var i,l=Object(m.a)(this.state.allSlots);try{for(l.s();!(i=l.n()).done;){var u=i.value;if(u.id===n){var h,d=Object(m.a)(u.sensors);try{for(d.s();!(h=d.n()).done;){var p=h.value;p.id===r&&(p.changed=!0,a=p)}}catch(b){d.e(b)}finally{d.f()}break}}}catch(b){l.e(b)}finally{l.f()}var f,v=Object(m.a)(s);try{for(v.s();!(f=v.n()).done;){if(f.value.id===a.id)return void N.a.show("\u4f20\u611f\u5668\u91cd\u590d!",1,!1)}}catch(b){v.e(b)}finally{v.f()}s[o]=a,this.setState({sensors:s})}},{key:"render",value:function(){var e=this,t=this.state,a=t.slot,n=t.sensors,o=t.sensorRemoveMode;return r.a.createElement("div",null,r.a.createElement(H.a,{renderHeader:function(){return"\u8d27\u9053\u4fe1\u606f"}},r.a.createElement(H.a.Item,{extra:a.slotNo},"\u8d27\u9053\u53f7"),r.a.createElement(H.a.Item,{extra:a.skuName},"SKU\u540d\u79f0"),r.a.createElement(H.a.Item,{extra:a.skuNo},"SKU\u53f7")),r.a.createElement(H.a,{renderHeader:function(){return"Sensors"}},n.map((function(t){return e.renderSensorItem(t)})),r.a.createElement(H.a.Item,null,r.a.createElement(_.a,null,r.a.createElement(T.a,{justify:"between"},r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"warning",onClick:function(){return e.setState({sensorRemoveMode:!e.state.sensorRemoveMode})}},o?"\u9000\u51fa\u5220\u9664":"\u5220\u9664")),r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"ghost",onClick:function(){return e.addSensor()},disabled:o},"\u6dfb\u52a0")),r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"primary",disabled:o,onClick:function(){return e.applySensors()}},"\u4fdd\u5b58")))))))}},{key:"addSensor",value:function(){var e,t=Object(m.a)(this.state.sensors);try{for(t.s();!(e=t.n()).done;){if(e.value.id<0)return void N.a.show("\u8bf7\u9009\u62e9\u4e00\u4e2a\u4f20\u611f\u5668!",1,!1)}}catch(n){t.e(n)}finally{t.f()}var a=this.state.sensors;a.push({id:-1,deviceSn:"\u672a\u9009\u62e9",changed:!0}),this.setState({sensors:a})}},{key:"openSensorOperations",value:function(e){var t=this;this.state.sensorRemoveMode&&Se.a.showActionSheetWithOptions({options:ot,title:"\u4f20\u611f\u5668 ".concat(e.deviceSn),cancelButtonIndex:2,destructiveButtonIndex:0},(function(a){0===a&&B.a.alert("\u79fb\u9664\u4f20\u611f\u5668","\u79fb\u9664\u4f20\u611f\u5668 ".concat(e.deviceSn,"?"),[{text:"\u53d6\u6d88"},{text:"\u79fb\u9664",onPress:function(){return t.removeSensor(e)}}])}))}},{key:"removeSensor",value:function(e){var t=this.state.sensors,a=[];for(var n in t)if(t.hasOwnProperty(n)){var r=t[n];r.id!==e.id&&a.push(r)}this.setState({sensors:a})}},{key:"applySensors",value:function(){var e,t=this,a=this.state.sensors.map((function(e){return e.id})),n=Object(m.a)(a);try{for(n.s();!(e=n.n()).done;){if(e.value<=0)return void N.a.show("Any sensor not selected!",1,!1)}}catch(o){n.e(o)}finally{n.f()}var r=this.state.slot;B.a.alert("Apply Sensor Setting","Do you want to apply this changes?",[{text:"Cancel"},{text:"Apply",onPress:function(){(function(e,t){return J({url:"/api/sensor/_set-slot-id-by-ids",method:"post",data:{sensorIds:e,slotId:t}})})(a,r.id).then((function(e){N.a.show("Apply Success!");var a,n=t.state.sensors,r=Object(m.a)(n);try{for(r.s();!(a=r.n()).done;){a.value.changed=!1}}catch(o){r.e(o)}finally{r.f()}t.setState({sensors:n})}))}}])}}]),a}(n.Component),ct=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(st),it=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={sensors:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.refresh()}},{key:"refresh",value:function(){var e=this;J({url:"/api/sensor/_dump-all",method:"get"}).then((function(t){var a=t.sort((function(e,t){return e.address-t.address}));e.setState({sensors:a})}))}},{key:"render",value:function(){var e=this,t=this.state.sensors;return r.a.createElement("div",{className:"overview"},r.a.createElement(H.a,{renderHeader:function(){return"All Sensors"}},t.map((function(t){return r.a.createElement(H.a.Item,{key:t.id},e.renderSensorItem(t))}))),r.a.createElement(_.a,null,r.a.createElement(ze.a,{onClick:function(){return e.refresh()},type:"primary"},"\u5237\u65b0")))}},{key:"renderSensorItem",value:function(e){var t=this,a=e.slot,n=e.connection;return r.a.createElement("div",{onClick:function(){return t.onSensorClick(e)}},"\u4f20\u611f\u5668:[id:",e.id,"/address:",e.address,"] \u8d27\u9053:[id:",a&&a.id,"/No:",a&&a.slotNo,"] \u8fde\u63a5:[id:",n&&n.id,"/",n&&n.target,"]")}},{key:"onSensorClick",value:function(e){var t=e.connection,a=e.slot;e.slot=null,e.connection=null;var n=r.a.createElement(H.a,{renderHeader:function(){return"\u4f20\u611f\u5668"}},r.a.createElement(Qe.a,{value:JSON.stringify(e),autoHeight:!0}),r.a.createElement(Qe.a,{value:JSON.stringify(t),autoHeight:!0}),r.a.createElement(Qe.a,{value:JSON.stringify(a),autoHeight:!0}));B.a.alert("Sensor",n)}}]),a}(n.Component),lt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={statusTable:{tcpApi:{}},databaseTables:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u7cfb\u7edf\u68c0\u67e5"),this.refreshStatusTable()}},{key:"refreshStatusTable",value:function(){var e=this;J({url:"/api/status/",method:"get"}).then((function(t){e.setState({statusTable:t})}))}},{key:"refreshDatabaseTables",value:function(){var e=this;J({url:"/api/status/tables",method:"get"}).then((function(t){e.setState({databaseTables:t})}))}},{key:"render",value:function(){var e,t=this,a=this.state,n=a.statusTable,o=a.databaseTables,s=n.tcpApi;return r.a.createElement("div",{className:"system-check"},r.a.createElement(H.a,{renderHeader:function(){return"SCADA_API\u72b6\u6001"}},r.a.createElement(H.a.Item,{extra:(e=s.connection,e?r.a.createElement("span",{style:{color:"#1F90E6"}},"Connected"):r.a.createElement("span",{style:{color:"#E94F4F"}},"Disconnected"))},"\u8fde\u63a5\u72b6\u6001"),r.a.createElement(H.a.Item,{extra:s.ip},"IP\u5730\u5740"),r.a.createElement(H.a.Item,{extra:s.port},"\u7aef\u53e3"),r.a.createElement(H.a.Item,{arrow:"horizontal",onClick:function(){return t.props.history.push({pathname:"/setting/message-log"})}},"\u4ea4\u4e92\u65e5\u5fd7"),r.a.createElement(H.a.Item,null,r.a.createElement(T.a,{justify:"between"},r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"warning",onClick:function(){return t.reconnectTcp()}},"\u91cd\u65b0\u8fde\u63a5")),r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"primary",onClick:function(){return t.refreshStatusTable()}},"\u5237\u65b0"))))),r.a.createElement(H.a,{renderHeader:function(){return"\u4f20\u611f\u5668\u4fe1\u606f"}},r.a.createElement(H.a.Item,{arrow:"horizontal",onClick:function(){return t.props.history.push({pathname:"/setting/sensor-healthy"})}},"\u4f20\u611f\u5668\u5065\u5eb7")),r.a.createElement(H.a,{renderHeader:function(){return"\u6570\u636e\u5e93\u4fe1\u606f"}},o.map((function(e){return r.a.createElement(H.a.Item,{key:e},e)})),r.a.createElement(H.a.Item,null,r.a.createElement(T.a,null,r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"warning",onClick:function(){return t.showDbResetConfirm()}},"\u91cd\u7f6e\u6570\u636e\u5e93")),r.a.createElement(T.a.Item,null,r.a.createElement(ze.a,{type:"primary",onClick:function(){return t.refreshDatabaseTables()}},"\u6570\u636e\u8868"))))))}},{key:"reconnectTcp",value:function(){B.a.alert("\u5708\u5b9a\u91cd\u8fde","\u786e\u5b9a\u6bb5\u8003\u8fde\u63a5\u5e76\u91cd\u65b0\u5efa\u7acb\u8fde\u63a5\uff1f?",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",onPress:function(){J({url:"/api/status/tcp-disconnect",method:"post"}).then((function(){N.a.show("\u65ad\u5f00\u6210\u529f\uff0c\u7cfb\u7edf\u5c06\u57283\u79d2\u540e\u91cd\u65b0\u8fde\u63a5!",3,!1)}))}}])}},{key:"showDbResetConfirm",value:function(){var e=this;B.a.alert("\u6e05\u7a7a\u6570\u636e\u5e93\uff1f","\u8be5\u64cd\u4f5c\u5c06\u4f1a\u6e05\u7a7a\u6570\u636e\u5e93\u4e2d\u5168\u90e8\u5185\u5bb9\uff0c\u64cd\u4f5c\u5b8c\u6210\u540e\u9700\u8981\u5bf9\u8d27\u9053\u91cd\u65b0\u626b\u63cf\u5e76\u91cd\u65b0\u4e0b\u53d1\u5e93\u4f4d\u4fe1\u606f\uff01\uff08\u8be5\u64cd\u4f5c\u65e0\u6cd5\u6062\u590d\uff09",[{text:"\u53d6\u6d88"},{text:"\u786e\u5b9a",onPress:function(){return e.doDbReset()}}])}},{key:"doDbReset",value:function(){J({url:"/api/status/_db-reset",method:"post"}).then((function(){B.a.alert("Database Reset Success!","Reset success, please scan again!")}))}}]),a}(n.Component),ut=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(lt),ht=Object(O.f)(ut),mt=(a(489),function(e,t){return r.a.createElement(H.a.Item,{key:t},r.a.createElement(je.a,{className:"message-item"},r.a.createElement(je.a.Header,{title:e.action,extra:e.type}),r.a.createElement(je.a.Body,null,r.a.createElement(Qe.a,{value:JSON.stringify(e.data),rows:3})),r.a.createElement(je.a.Footer,{content:e.seqNo})))}),dt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={logs:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){var e=this;this.refreshLogs(),this.refreshTimmer=setInterval((function(){e.refreshLogs()}),1e3)}},{key:"componentWillUnmount",value:function(){clearInterval(this.refreshTimmer)}},{key:"refreshLogs",value:function(){var e=this;J({url:"/api/status/message-log",method:"get"}).then((function(t){e.setState({logs:t})}))}},{key:"render",value:function(){var e=this.state.logs;return r.a.createElement("div",{className:"message-log"},r.a.createElement(H.a,{renderHeader:function(){return"Message Logs"}},e.map(mt)))}}]),a}(n.Component),pt=(a(490),a(350)),ft=a.n(pt),vt=(a(492),["Clean","Refresh","Cancel"]),bt=["Firmware Upgrade","Cancel"],yt={0:"\u7b49\u5f85\u5347\u7ea7",1:"\u5347\u7ea7\u6210\u529f",2:"\u5347\u7ea7\u5931\u8d25",3:"\u5347\u7ea7\u4e2d"},Et=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={sensors:[],upgradePercent:0,upgradeProgress:{}},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.refreshSensors()}},{key:"componentWillUnmount",value:function(){this.tryReleaseUpgradeProgressTimmer()}},{key:"tryReleaseUpgradeProgressTimmer",value:function(){this.upgradeFirmwareTimmer&&clearTimeout(this.upgradeFirmwareTimmer)}},{key:"refreshSensors",value:function(){var e=this;J({url:"/api/sensor-healthy/_healthy",method:"get"}).then((function(t){e.setState({sensors:t,showUpgradeProgress:!1})}))}},{key:"refreshUpgradeProgress",value:function(e){var t=this;J({url:"/api/firmware/_upgrade-progress",method:"get",hideLoading:!0}).then((function(a){t.setState({upgradeProgress:a}),e(a)}))}},{key:"doAbortFirmwareUpgrade",value:function(){J({url:"/api/firmware/_abort-upgrade",method:"post"}).then((function(){N.a.show("\u5347\u7ea7\u5df2\u53d6\u6d88",3,!1)})),this.tryReleaseUpgradeProgressTimmer()}},{key:"render",value:function(){var e=this,t=this.state,a=t.sensors,n=t.showUpgradeProgress,o=t.upgradeProgress,s=0;return void 0!==o.total&&void 0!==o.current&&0!==o.total&&(s=o.current/o.total*100),r.a.createElement("div",null,r.a.createElement(H.a,{renderHeader:function(){return"Sensor Healthy"}},a.map((function(t){return r.a.createElement(H.a.Item,{key:t.sensor.id},e.renderSensorCard(t))}))),r.a.createElement(B.a,{visible:n,title:"\u5347\u7ea7\u8fdb\u5ea6",transparent:!0,maskClosable:!1,onClose:function(){return e.onUpgradeProgressModalClose()},footer:[{text:"Abort Upgrade",disabled:!0,onPress:function(){e.onUpgradeProgressModalClose(),e.doAbortFirmwareUpgrade()}}]},r.a.createElement("p",null,yt[o.state]),r.a.createElement("p",null,s.toFixed(2),"%"),r.a.createElement(ft.a,{percent:s,position:"normal"})),r.a.createElement(Te,{iconType:"ellipsis",onClick:function(){return e.showOperations()}}))}},{key:"onCardClick",value:function(e){var t=this;Se.a.showActionSheetWithOptions({options:bt,title:"Sensor Operations",cancelButtonIndex:bt.length-1,destructiveButtonIndex:0},(function(a){0===a&&t.upgradeFirmware(e)}))}},{key:"upgradeFirmware",value:function(e){var t=this,a=e.sensor,n=e.packageCounter,r=n.totalSuccess+n.totalErrors,o=0===r?0:n.totalErrors/r,s="",c="",i=!1,l=(100*o).toFixed(2);if(o>.1){var u=10..toFixed(2);s="\u8c28\u614e\u5347\u7ea7\uff01\uff01\uff01",c="\u4f20\u611f\u5668".concat(a.address,"\u7684\u7f51\u7edc\u4e22\u5305\u7387\u4e3a").concat(l,"%\uff0c\u5728\u6781\u9650\u503c").concat(u,"%\u4e0b\uff0c\u5efa\u8bae\u901a\u8fc7\u4e32\u53e3\u5347\u7ea7\uff01"),i=!0}else s="\u5347\u7ea7\u786e\u8ba4",c="\u4f20\u611f".concat(a.address,"\u5668\u7684\u7f51\u7edc\u4e22\u5305\u7387\u4e3a").concat(l,"%,\u5347\u7ea7\u540e\u8bf7\u624b\u52a8reload\u542f\u52a8\u91cd\u529b\u670d\u52a1\uff01"),i=!1;B.a.alert(s,c,[{text:i?"\u4ecd\u8981\u5347\u7ea7":"\u5347\u7ea7",onPress:function(){t.doFirmwareUpgrade(a)}},{text:"\u53d6\u6d88\u5347\u7ea7"}])}},{key:"doFirmwareUpgrade",value:function(e){var t,a=this;this.tryReleaseUpgradeProgressTimmer(),(t=e.id,J({url:"/api/firmware/".concat(t,"/_upgrade"),method:"post",hideLoading:!0})).then((function(){N.a.show("\u5347\u7ea7\u5df2\u5b8c\u6210",2,!1),a.tryReleaseUpgradeProgressTimmer()})),this.showUpgradeProgress(),this.refreshUpgradeProgress(this.refreshUpgradeProgressCb())}},{key:"refreshUpgradeProgressCb",value:function(){var e=this;return function(){e.upgradeFirmwareTimmer=setTimeout((function(){e.refreshUpgradeProgress(e.refreshUpgradeProgressCb())}),500)}}},{key:"showUpgradeProgress",value:function(){this.setState({showUpgradeProgress:!0})}},{key:"onUpgradeProgressModalClose",value:function(){this.setState({showUpgradeProgress:!1})}},{key:"renderSensorCard",value:function(e){var t=this,a=e.sensor,n=e.packageCounter,o="ZeroOffset:".concat(a.zeroReference),s=n.totalSuccess+n.totalErrors,c=0===s?0:(n.totalSuccess/s*100).toFixed(0),i=0===s?0:(n.totalErrors/s*100).toFixed(0),l=n.elabelSuccess,u=n.elabelErrors,h=u+l,m=0===h?0:(l/h*100).toFixed(0),d=0===h?0:(u/h*100).toFixed(0),p=n.elabelContinueErrors;return r.a.createElement(je.a,{key:a.id,onClick:function(){return t.onCardClick(e)}},r.a.createElement(je.a.Header,{title:a.address,extra:a.deviceSn}),r.a.createElement(je.a.Body,{className:"healthy-package-counter"},r.a.createElement(T.a,null,r.a.createElement(T.a.Item,null,r.a.createElement("div",{className:"total"},r.a.createElement("p",{className:"title"},"SUCCESS"),r.a.createElement("p",{className:"value"},n.totalSuccess,"/",c,"%"),r.a.createElement("p",{className:"title"},"ELABEL SUCCESS"),r.a.createElement("p",{className:"value"},l,"/",m,"%"))),r.a.createElement(T.a.Item,null,r.a.createElement("div",{className:"error"},r.a.createElement("p",{className:"title"},"ERRORS"),r.a.createElement("p",{className:"value"},n.totalErrors,"/",i,"%"),r.a.createElement("p",{className:"title"},"ELABEL ERRORS"),r.a.createElement("p",{className:"value"},u,"/",d,"%"))),r.a.createElement(T.a.Item,null,r.a.createElement("div",{className:"continue"},r.a.createElement("p",{className:"title"},"CONTINUE"),r.a.createElement("p",{className:"value"},n.continueErrors),r.a.createElement("p",{className:"title"},"ELABEL CONTINUE"),r.a.createElement("p",{className:"value"},p))))),r.a.createElement(je.a.Footer,{content:o}))}},{key:"showOperations",value:function(){var e=this;Se.a.showActionSheetWithOptions({options:vt,title:"Operations",cancelButtonIndex:vt.length-1,destructiveButtonIndex:0},(function(t){switch(t){case 0:e.showCleanCounterConfirm();break;case 1:e.refreshSensors()}}))}},{key:"showCleanCounterConfirm",value:function(){var e=this;B.a.alert("Clean Counter?","Clean counter?",[{text:"Cancel"},{text:"Yes",onPress:function(){return e.doCleanCounter()}}])}},{key:"doCleanCounter",value:function(){J({url:"/api/sensor-healthy/_clean-counter",method:"post"}).then((function(){N.a.show("Clean success!",1,!1)}))}}]),a}(n.Component),gt=["\u5237\u65b0","\u53d6\u6d88"],kt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={sensor:{},slot:{},sensorParams:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u4f20\u611f\u5668\u8be6\u7ec6\u53c2\u6570"),this.props.setTabBarState(!1);var e=this.props.match.params.address;this.refreshParams(e)}},{key:"refreshParams",value:function(e){var t=this;(function(e){return J({url:"/api/status/".concat(e,"/_details"),method:"get"})})(e).then((function(e){var a=e.slot,n=e.sensor;delete e.slot,delete e.sensor;var r=[];for(var o in e)e.hasOwnProperty(o)&&r.push({name:o,value:e[o]});t.setState({sensor:n,slot:a,sensorParams:r})}))}},{key:"render",value:function(){var e=this,t=this.state,a=t.sensor,n=t.slot,o=t.sensorParams;return r.a.createElement("div",{className:"sensor-details"},r.a.createElement(H.a,{renderHeader:function(){return"\u4f20\u611f\u5668\u57fa\u672c\u4fe1\u606f"}},r.a.createElement(H.a.Item,{extra:a.deviceSn},"\u5e8f\u5217\u53f7"),r.a.createElement(H.a.Item,{extra:a.hasElabel?"yes":"no"},"\u7535\u5b50\u6807\u7b7e"),r.a.createElement(H.a.Item,{extra:a.address},"\u5730\u5740"),r.a.createElement(H.a.Item,{extra:a.zeroReference},"\u96f6\u70b9\u504f\u79fb"),r.a.createElement(H.a.Item,{extra:n.slotNo},"\u7ed1\u5b9a\u8d27\u9053\u53f7"),r.a.createElement(H.a.Item,{extra:n.skuApw},"SKU\u5355\u91cd"),r.a.createElement(H.a.Item,{extra:n.skuName},"SKU\u540d\u79f0"),r.a.createElement(H.a.Item,{extra:n.skuTolerance},"SKU\u5141\u5dee"),r.a.createElement(H.a.Item,{extra:n.skuNo},"SKU\u53f7")),r.a.createElement(H.a,{renderHeader:function(){return"\u4f20\u611f\u5668\u786c\u4ef6\u4fe1\u606f"}},o.map((function(e){return r.a.createElement(H.a.Item,{key:e.name,extra:JSON.stringify(e.value)},e.name)}))),r.a.createElement(Te,{iconType:"ellipsis",onClick:function(){return e.showOperations()}}))}},{key:"showOperations",value:function(){var e=this;Se.a.showActionSheetWithOptions({options:gt,title:"\u64cd\u4f5c\u9009\u62e9",cancelButtonIndex:gt.length-1,destructiveButtonIndex:0},(function(t){switch(t){case 0:e.refreshParams(e.props.match.params.address)}}))}}]),a}(n.Component),St=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))},setTabBarState:function(){return e(X.apply(void 0,arguments))}})}))(kt),Ot=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={sensors:[]},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668"),this.refreshSensors()}},{key:"refreshSensors",value:function(){var e=this;J({url:"/api/th-sensor/",method:"get"}).then((function(t){e.setState({sensors:t})}))}},{key:"toDetail",value:function(e){this.props.history.push({pathname:"/setting/".concat(e.id,"/th-detail")})}},{key:"render",value:function(){var e=this,t=this.state.sensors;return r.a.createElement("div",{className:"th-sensors"},r.a.createElement(H.a,{renderHeader:function(){return"\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668"}},t.map((function(t){return r.a.createElement(H.a.Item,{key:t.id,arrow:"horizontal",onClick:function(){return e.toDetail(t)}},t.no," [",t.address,"]")}))))}}]),a}(n.Component),Ct=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(Ot),wt=(a(493),a(351)),jt=a.n(wt),Nt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(i.a)(a,[{key:"onCanvasLoad",value:function(e){e&&e!==this.canvas&&(this.canvas=e,this.charts=jt.a.init(this.canvas),this.refreshCharts())}},{key:"refreshCharts",value:function(){var e,t=this.props,a=t.xData,n=t.yData,r=[],o=[],s=Object(m.a)(n);try{for(s.s();!(e=s.n()).done;){var c=e.value;o.push(c.name),r.push(Object(d.a)({},c,{type:"line"}))}}catch(l){s.e(l)}finally{s.f()}var i={tooltip:{trigger:"axis"},legend:{data:o},xAxis:{type:"category",data:a},yAxis:{type:"value"},series:r};this.charts.setOption(i)}},{key:"render",value:function(){var e=this,t=this.props,a=t.width,n=t.height;return r.a.createElement("canvas",{ref:function(t){return e.onCanvasLoad(t)},className:"charts",height:n,width:a})}}]),a}(n.Component);Nt.defaultProps={width:1e3,height:300,xData:[],yData:[]};var It=Nt,Tt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={sensor:{},dataLogs:[],chartsXData:[],chartsYData:[]},n}return Object(i.a)(a,[{key:"refreshDataLog",value:function(){var e,t=this;(e=this.sensorId,J({url:"/api/temp-humidity-log/_sensor-logs",method:"get",params:{sensorId:e}})).then((function(e){var a,n=[],r=[],o=[],s=[],c=Object(m.a)(e);try{for(c.s();!(a=c.n()).done;){var i=a.value,l=i.createTime,u=i.temperature,h=i.maxTemperature,d=i.minTemperature,p=new Date(l),f="".concat(p.getHours(),":").concat(p.getMinutes(),":").concat(p.getSeconds());n.push(f),r.push(u),o.push(h),s.push(d)}}catch(b){c.e(b)}finally{c.f()}var v=[{name:"\u6e29\u5ea6",data:r},{name:"\u6e29\u5ea6\u4e0a\u9650",data:o},{name:"\u6e29\u5ea6\u4e0b\u9650",data:s}];t.setState({dataLogs:e,chartsXData:n,chartsYData:v}),t.charts.refreshCharts()}))}},{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.id;this.sensorId=t,this.props.setTitle("\u6e29\u6e7f\u5ea6\u4f20\u611f\u5668\u62a5\u8b66\u8303\u56f4"),this.refreshDataLog(),function(e){return J({url:"/api/th-sensor/".concat(e),method:"get"})}(t).then((function(t){e.setState({sensor:t})}))}},{key:"setSensorData",value:function(e){var t=this.state.sensor;this.setState({sensor:Object(d.a)({},t,{},e)})}},{key:"render",value:function(){var e=this,t=this.state,a=t.sensor,n=t.dataLogs,o=t.chartsXData,s=t.chartsYData;return r.a.createElement("div",{className:"th-sensor-detail"},r.a.createElement(H.a,{renderHeader:function(){return"\u62a5\u8b66\u8303\u56f4"}},r.a.createElement(_e.a,{value:a.maxTemperature,labelNumber:10,onChange:function(t){return e.setSensorData({maxTemperature:t})}},"\u6e29\u5ea6\u4e0a\u9650(\xb0C)\uff1a"),r.a.createElement(_e.a,{value:a.minTemperature,labelNumber:10,onChange:function(t){return e.setSensorData({minTemperature:t})}},"\u6e29\u5ea6\u4e0b\u9650(\xb0C)\uff1a"),r.a.createElement(_e.a,{value:a.maxHumidity,labelNumber:10,onChange:function(t){return e.setSensorData({maxHumidity:t})}},"\u6e7f\u5ea6\u4e0a\u9650( %)\uff1a"),r.a.createElement(_e.a,{value:a.minHumidity,labelNumber:10,onChange:function(t){return e.setSensorData({minHumidity:t})}},"\u6e7f\u5ea6\u4e0b\u9650( %)\uff1a"),r.a.createElement(H.a.Item,null,r.a.createElement(ze.a,{type:"primary",onClick:function(){return e.updateRange()}},"\u4fdd\u5b58"))),r.a.createElement(je.a,null,r.a.createElement(je.a.Header,{title:"\u5386\u53f2\u6570\u636e"}),r.a.createElement(je.a.Body,null,r.a.createElement(It,{width:500,height:300,xData:o,yData:s,ref:function(t){return e.charts=t}})),r.a.createElement(je.a.Footer,{content:n.length})),r.a.createElement(H.a,{renderHeader:function(){return"\u6e29\u6e7f\u5ea6\u65e5\u5fd7"}},n.map((function(e){return r.a.createElement(H.a.Item,{key:e.id},r.a.createElement(T.a,null,r.a.createElement(T.a.Item,null,e.createTime),r.a.createElement(T.a.Item,null,"\u6e29\u5ea6:",e.temperature,"\xb0C(",me(e.temperatureState),")")))}))))}},{key:"updateRange",value:function(){var e,t=this;(e=this.state.sensor,J({url:"/api/th-sensor/".concat(e.id,"/_range"),method:"post",data:e})).then((function(e){t.setState({sensor:e}),t.showReloadConfirm()}))}},{key:"showReloadConfirm",value:function(){B.a.alert("\u91cd\u65b0\u52a0\u8f7d","\u6570\u636e\u5df2\u66f4\u65b0\uff0c\u662f\u5426\u91cd\u65b0\u52a0\u8f7d\u751f\u6548\uff1f",[{text:"No"},{text:"Yes",onPress:function(){Y().then((function(){N.a.show("\u91cd\u65b0\u52a0\u8f7d\u6210\u529f",1,!1)}))}}])}}]),a}(n.Component),xt=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(Tt),Pt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(ge.a,null,r.a.createElement(O.c,null,r.a.createElement(O.a,{path:"/setting/",component:Be,exact:!0}),r.a.createElement(O.a,{path:"/setting/sensor",component:Pe,exact:!0}),r.a.createElement(O.a,{path:"/setting/slot",component:Me,exact:!0}),r.a.createElement(O.a,{path:"/setting/connection",component:Je,exact:!0}),r.a.createElement(O.a,{path:"/setting/slot-detail/:id",component:Ge,exact:!0}),r.a.createElement(O.a,{path:"/setting/system",component:tt,exact:!0}),r.a.createElement(O.a,{path:"/setting/system-props",component:rt,exact:!0}),r.a.createElement(O.a,{path:"/setting/slot-sensors/:id",component:ct,exact:!0}),r.a.createElement(O.a,{path:"/setting/overview",component:it,exact:!0}),r.a.createElement(O.a,{path:"/setting/system-check",component:ht,exact:!0}),r.a.createElement(O.a,{path:"/setting/message-log",component:dt,exact:!0}),r.a.createElement(O.a,{path:"/setting/sensor-healthy",component:Et,exact:!0}),r.a.createElement(O.a,{path:"/setting/th-sensor",component:Ct,exact:!0}),r.a.createElement(O.a,{path:"/setting/:address/sensor-details",component:St,exact:!0}),r.a.createElement(O.a,{path:"/setting/:id/th-detail",component:xt,exact:!0})))}}]),a}(n.Component),Dt=Object(g.b)(null,(function(e,t){return Object(d.a)({},t)}))(Pt),Bt=(a(788),a(352)),Ut=a.n(Bt),Ht=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.props.setTitle("Config Address"),n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",null,r.a.createElement(Ut.a,{img:r.a.createElement(Ie.a,{type:"check-circle",size:"lg",style:{fill:"#1F90E6"}}),title:"\u5f00\u53d1\u4e2d",message:"\u5f00\u53d1\u4e2d"}))}},{key:"componentDidMount",value:function(){N.a.info("\u5f00\u53d1\u4e2d",1,null,!1)}}]),a}(n.Component),Lt=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(Ht),Mt=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n.props.setTitle("Logs"),n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement(dt,null)}}]),a}(n.Component),Ft=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(Mt),At=(a(790),a(353)),Rt=a.n(At),_t=(a(793),a(354)),Vt=a.n(_t),zt=(a(795),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={drawerOpen:!1},n}return Object(i.a)(a,[{key:"componentDidMount",value:function(){this.props.setTitle("About")}},{key:"render",value:function(){return r.a.createElement("div",{className:"about"},r.a.createElement(P.a,{marqueeProps:{loop:!0}},"\u78d0\u77f3\u7535\u6c14\uff08\u5e38\u5dde\uff09\u6709\u9650\u516c\u53f8\uff1ahttp://www.monolith-iot.com"),r.a.createElement(Vt.a,null),r.a.createElement(_.a,null,r.a.createElement(Rt.a,{autoplay:!0,infinite:!0,className:"headerCarousel"},r.a.createElement("div",{className:"carouselItem",style:{backgroundColor:"#FF9808"}},r.a.createElement("div",{className:"title"},"\u78d0\u77f3\u7535\u6c14\uff08\u5e38\u5dde\uff09\u6709\u9650\u516c\u53f8")),r.a.createElement("div",{className:"carouselItem",style:{backgroundColor:"#3171FA"}},r.a.createElement("div",{className:"title"},"MonolithIoT")))),r.a.createElement(_.a,{className:"article"},r.a.createElement("h1",{className:"title"},"\u5173\u4e8e\u6211\u4eec"),r.a.createElement("div",{className:"text"},r.a.createElement("p",null,"\u78d0\u77f3\u7535\u6c14(\u5e38\u5dde)\u6709\u9650\u516c\u53f8,\u662f\u4e00\u5bb6\u9ad8\u79d1\u6280\u667a\u80fd\u6d4b\u91cf\u88c5\u5907\u7814\u53d1\u53ca\u751f\u4ea7\u4f01\u4e1a\uff0c\u628a\u4f20\u7edf\u4f53\u79ef\uff0c\u91cd\u91cf\u7684\u6d4b\u91cf\u6570\u5b57\u5316\u7269\u8054\u7f51\u5316\uff0c\u53ef\u4ee5\u4e0eWMS,ERP\uff0cSAP\u7b49\u4f01\u4e1a\u7ba1\u7406\u8f6f\u4ef6\u76f8\u7ed3\u5408\uff0c\u4fbf\u4e8e\u4f01\u4e1a\u66f4\u76f4\u89c2\u7684\u7ba1\u7406\u81ea\u5df1\u7684\u4ed3\u50a8\uff0c\u7269\u6d41\u7b49\u3002\u78d0\u77f3\u7535\u6c14\u4e0b\u8bbe\u7814\u53d1\u90e8\uff0c\u5de5\u7a0b\u90e8\uff0c\u4e1a\u52a1\u90e8\uff0c\u6709\u8f83\u5f3a\u7684\u8bbe\u8ba1\uff0c\u7814\u53d1\u548c\u751f\u4ea7\u80fd\u529b\uff0c\u53ef\u4e3a\u5ba2\u6237\u63d0\u4f9b\u5d4c\u5165\u5f0f\u8ba1\u7b97\u673a\u7cfb\u7edf\u4ea7\u54c1\u8bbe\u8ba1\uff0c\u5f00\u53d1\uff0c\u7cfb\u7edf\u96c6\u6210\uff0c\u5de5\u7a0b\u5b9e\u65bd\u7b49\u670d\u52a1\u3002"),r.a.createElement("p",null,"\u968f\u7740\u516c\u53f8\u7684\u53d1\u5c55\uff0c\u4e3b\u8981\u4ea7\u54c1\u6709\u81ea\u4e3b\u7814\u53d1\u7684\u667a\u80fd\u6570\u5b57\u5377\u5c3a\uff0c\u667a\u80fd\u624b\u52a8\u53c9\u8f66\u79e4\uff0c\u5b89\u5353\u667a\u80fd\u79f0\u91cd\u7ec8\u7aef\uff0c\u9759\u6001/\u52a8\u6001DWS\u7b49\u5404\u79cd\u7269\u8054\u7f51\u7c7b\u667a\u80fd\u79f0\u91cd\u91cf\u65b9\u8bbe\u5907\u53ca\u8f6f\u4ef6\u5b9a\u5236\u7cfb\u7edf,\u53ef\u4e3a\u5ba2\u6237\u6700\u5927\u7a0b\u5ea6\u5730\u63d0\u4f9b\u667a\u80fd\u5316\u7cfb\u7edf\u5316\u7684\u6d4b\u91cf\u7cfb\u7edf\u89e3\u51b3\u65b9\u6848\u3002\u4ea7\u54c1\u5e7f\u6cdb\u5e94\u7528\u4e8e\u5feb\u9012\u7269\u6d41\u3001\u751f\u9c9c\u4f9b\u5e94\u3001\u6e2f\u53e3\u8ba2\u8231\u3001\u4ed3\u50a8\u3001\u5de5\u4e1a\u79bb\u6563\u5236\u9020\u53ca\u5404\u79cd\u4ee5\u957f\u5ea6(\u542b\u9762 \u79ef\u3001\u4f53\u79ef)\u6d4b\u91cf\u4e3a\u624b\u6bb5\u7684\u6c11\u7528\u3001\u5546\u7528\u7528\u9014\u4e2d\u3002\u51ed\u7740\u53ef\u9760\u7684\u4ea7\u54c1\u8d28\u91cf\u548c\u826f\u597d\u7684\u552e\u540e\u670d\u52a1\uff0c\u6211\u516c\u53f8\u5df2\u4e0e\u987a\u4e30\u3001\u4e2d\u56fd\u90ae\u653f\u3001\u4eac\u4e1c\u3001\u56fd\u9645\u5feb\u9012DHL\u3001\u534e\u4e3a\u7b49\u591a\u5bb6\u77e5\u540d\u4f01\u4e1a\u5408\u4f5c\u3002"),r.a.createElement("p",null,"\u76ee\u524d\u516c\u53f8\u5df2\u7533\u8bf7\u4e2d\u56fd\u4e13\u522924\u9879,\u7f8e\u56fd\u4e13\u52291\u9879\uff0c\u5e76\u62e5\u6709\u4e00\u652f\u4ee5\u535a\u58eb\u3001\u7855\u58eb\u4e3a\u4e3b\u7684\u4f18\u79c0\u7814\u53d1\u56e2\u961f\uff0c\u5177\u6709\u8f83\u9ad8\u7684\u7814\u53d1\u80fd\u529b\u548c\u7ba1\u7406\u6c34\u5e73\uff0c\u73b0\u6709\u591a\u540d\u5458\u5de5\u66fe\u5728\u5916\u4f01\u4f5c\u4e3a\u6280\u672f\u9aa8\u5e72\uff0c\u627f\u4f20\u6b27\u7f8e\u8bbe\u8ba1\u5236\u9020\u7406\u5ff5\uff0c\u5e76\u91c7\u7528\u5148\u8fdb\u7684\u4ea7\u54c1\u751f\u547d\u5468\u671f\u7ba1\u7406\uff08PLM\uff09\uff0c\u91cd\u89c6\u4ea7\u54c1\u8d28\u91cf\uff0c\u4e3a\u516c\u53f8\u4ea7\u54c1\u7684\u6280\u672f\u5f15\u9886\u3001\u6280\u672f\u521b\u65b0\u548c\u516c\u53f8\u7684\u53ef\u6301\u7eed\u53d1\u5c55\u5960\u5b9a\u4e86\u575a\u5b9e\u57fa\u7840\u3002"))))}}]),a}(n.Component)),Kt=Object(g.b)(null,(function(e,t){return Object(d.a)({},t,{setTitle:function(){return e(q.apply(void 0,arguments))}})}))(zt),Wt=(a(796),function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={},n}return Object(i.a)(a,[{key:"render",value:function(){return r.a.createElement("div",{className:"appContent"},this.props.showHeader?r.a.createElement("div",{className:"headerMask"}):null,r.a.createElement(O.c,null,r.a.createElement(O.a,{path:"/",component:Ee,exact:!0}),r.a.createElement(O.a,{path:"/setting**",component:Dt,exact:!0}),r.a.createElement(O.a,{path:"/address",component:Lt,exact:!0}),r.a.createElement(O.a,{path:"/logs",component:Ft,exact:!0}),r.a.createElement(O.a,{path:"/about",component:Kt,exact:!0})),r.a.createElement("div",{className:"tabBarMask"}))}}]),a}(n.Component)),Zt=Object(g.b)((function(e,t){return Object(d.a)({},t,{showHeader:e.showHeader})}),null)(Wt),Jt=(a(797),a(227)),Yt=a.n(Jt),Xt=(a(802),a(356)),qt=a.n(Xt),Gt=(a(804),["Enable","Disable","Cancel"]),$t=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(e){var n;return Object(c.a)(this,a),(n=t.call(this,e)).state={popoverVisible:!1},n}return Object(i.a)(a,[{key:"render",value:function(){var e=this;if(!this.props.showHeader)return null;var t=this.props.title;return r.a.createElement("div",{className:"appHeader"},r.a.createElement(qt.a,{leftContent:r.a.createElement(Ie.a,{type:"left",onClick:function(){return e.onBackClick()}}),rightContent:this.rightContent(),mode:"light"},t))}},{key:"rightContent",value:function(){var e=this,t=this.state.popoverVisible,a=Yt.a.Item;return r.a.createElement(Yt.a,{mask:!0,visible:t,overlay:[r.a.createElement(a,{key:"about",value:"about","data-seed":"logId"},"\u5173\u4e8e\u6211\u4eec"),r.a.createElement(a,{key:"settings",value:"settings",style:{whiteSpace:"nowrap"}},"\u8d27\u9053\u8bbe\u7f6e"),r.a.createElement(a,{key:"reload",value:"reload",style:{whiteSpace:"nowrap"}},"\u91cd\u65b0\u52a0\u8f7d"),r.a.createElement(a,{key:"doZero",value:"reload",style:{whiteSpace:"nowrap"}},"\u5168\u90e8\u6e05\u96f6"),r.a.createElement(a,{key:"compensation",value:"compensation",style:{whiteSpace:"nowrap"}},"\u8865\u507f\u7ba1\u7406")],onSelect:function(t){return e.onPopoverSelect(t)}},r.a.createElement(Ie.a,{type:"ellipsis"}))}},{key:"onBackClick",value:function(){this.props.history.goBack()}},{key:"onPopoverSelect",value:function(e){switch(e.key){case"about":this.props.history.push({pathname:"/about"});break;case"settings":this.props.history.push({pathname:"/setting/"});break;case"reload":this.doReloadSensors();break;case"doZero":this.showZeroAllConfirm();break;case"compensation":this.showCompensationOperations()}this.setState({popoverVisible:!1})}},{key:"showZeroAllConfirm",value:function(){B.a.alert("Zero All","Do zero for all sensors?",[{text:"Cancel"},{text:"Yes",onPress:function(){de().then((function(){N.a.show("Zero all success!",1,!1)}))}}])}},{key:"showCompensationOperations",value:function(){var e=this;Se.a.showActionSheetWithOptions({options:Gt,title:"Compensation operations",cancelButtonIndex:Gt.length-1,destructiveButtonIndex:1},(function(t){switch(Gt[t]){case"Enable":e.doSetCompensationState(!0);break;case"Disable":e.doSetCompensationState(!1)}}))}},{key:"doSetCompensationState",value:function(e){(function(e){return J({url:"/api/slot/_all-compensation",method:"post",data:{enableCompensation:e}})})(e).then((function(){var t=(e?"Enable":"Disable")+" Compensation Success!";N.a.show(t,1,!1)}))}},{key:"doReloadSensors",value:function(){B.a.alert("Reload Sensors","Reload sensors from database into weightService",[{text:"Cancel"},{text:"Yes",onPress:function(){Y().then((function(){N.a.show("Reload Success!")}))}}])}}]),a}(n.Component),Qt=Object(O.f)(Object(g.b)((function(e,t){return Object(d.a)({},t,{title:e.globalTitle,showHeader:e.showHeader})}))($t)),ea=a(357),ta=Object(ea.a)(),aa=function(e){var t=function(e){return{type:"router.path.set",data:e}}({pathname:e.pathname,search:e.search,hash:e.hash});E.dispatch(t)};ta.listen((function(e){aa(e.location)})),aa(ta.location);var na=ta,ra=function(){console.log("%cMonolithIoT%cPoweredBy%cLevent8421","color:#108EE9;font-size:50px;font-family:Microsoft-yahei;background-color:#F5F5F9","color:#FF8800;background-color:#F5F5F9","color:#108EE9;background-color:#F5F5F9")},oa=function(e){Object(u.a)(a,e);var t=Object(l.a)(a);function a(){return Object(c.a)(this,a),t.apply(this,arguments)}return Object(i.a)(a,[{key:"componentDidMount",value:function(){E.dispatch(ae()),ra()}},{key:"render",value:function(){return r.a.createElement(ge.a,{history:na},r.a.createElement(g.a,{store:E},r.a.createElement("div",{className:"app-content"},r.a.createElement(Qt,null),r.a.createElement(Zt,null),r.a.createElement(w,null))))}}]),a}(r.a.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));s.a.render(r.a.createElement(oa,null),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[358,1,2]]]);
//# sourceMappingURL=main.efde786a.chunk.js.map